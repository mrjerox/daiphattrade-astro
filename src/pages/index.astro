---
import Layout from "@layouts/Layout.astro";
import data from "@public/data.json";
import CardCategory from "@components/products/CardCategory.astro";
import ProductFeature from "@components/products/ProductFeature.astro";
import PromoSectionLarge from "@components/promo/PromoSectionLarge.astro";
import { optionsApi } from "@apis/optionsApi";
import { Debug } from "astro:components";
import { API_HOST } from "src/configs/api.conf";

// const generalOptions = await optionsApi.getGeneralOptions();
const homeOptions = await optionsApi.getHomeOptions();
const homeBanner =
  homeOptions?.themeGeneralSettingsPage?.themesGeneralSettings?.homeBanner;
const homeCategory =
  homeOptions?.themeGeneralSettingsPage?.themesGeneralSettings?.homeCategory;
const homeCategoryIds = homeCategory?.categories?.edges.map(
  (category: any) => category.node.id
);
---

<Debug data={homeCategoryIds} />
<Layout title="Home Page">
  <main>
    <PromoSectionLarge
      title={homeBanner?.title || ""}
      full_description={homeBanner?.description || ""}
      pageHeaderBgImg={API_HOST + homeBanner?.image?.node?.filePath ||
        "../images/bg2.jpg"}
      pageHeaderMinVh="90vh"
      buttonUrl={homeBanner?.link || ""}
      buttonText={"Explore Our Categories"}
    />
    <div class="categories pt-8" id="categories">
      <div class="container">
        <div class="d-block text-center mb-5">
          <h3>Shop by category</h3>
          <a class="text-dark font-weight-bold" href="/categories"
            >Browse all categories &#62;</a
          >
        </div>
        <div class="row mb-5">
          {
            homeCategory?.categories?.edges.map((category: any) => (
              <div class="col-md-6 col-lg-3">
                <CardCategory
                  thumb_src={category.thumb_src}
                  collection={category.collection}
                  title={category.title}
                />
              </div>
            ))
          }
        </div>

        <PromoSectionLarge
          title="Product Suggestions"
          full_description="Tailored product suggestions just for you discover items that match your preferences, needs, and style. Whether you're shopping for essentials or something special, we've got the perfect picks lined up."
          pageHeaderBgImg={"../images/bg2.jpg"}
          pageHeaderMinVh="50vh"
          pageHeaderRadius="1rem"
        />
        <div class="my-5">
          <ProductFeature
            title="Product Features"
            images={data.products[2].images || []}
            full_description="Society has put up so many boundaries, so many limitations on whatâ€™s right and wrong that it's almost impossible"
            featuresDetails={data.products[0].featuresDetails || {}}
          />
        </div>
        <div
          class="page-header mt-5 mb-10 rounded-top"
          style="background-image: url('https://images.unsplash.com/photo-1519642918688-7e43b19245d8?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2676&q=80');min-height: 50vh;"
        >
          <div class="faded opacity-10"></div>
          <div class="z-index-2">
            <div class="row justify-content-center">
              <div class="col-sm-9 text-center mx-auto pt-6">
                <h1 class="mb-4">Register for newsletter</h1>
                <p class="lead mb-sm-5 px-md-8">
                  Stay in the loop with our newsletter featuring the latest
                  updates, exclusive content, and special offers delivered
                  straight to your inbox.
                </p>
                <button
                  class="btn btn-dark btn-lg d-flex align-items-center mx-auto"
                >
                  Register
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</Layout>
